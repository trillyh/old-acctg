
{% extends 'accounting/index.html' %}
{% load dict_tags %}
	{% block content %}

<div class="content">
	<h1>Accounting Playground</h1>
	<p>Use this playground to experiment with accounting rules and concepts without logging in.</p>

	<div class="playground-entries"> 
		{% if entries %}
		<table class="entries-table">
			<thead>
				<tr>
					<th>Date</th>
					<th>Description</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody>

				<!-- Add new journal entry, if no form is currently in "editing mode" -->
				{% if not editing_entry %}
				<tr>
					<form method="post" action="{% url 'playground' %}">
						{% csrf_token %}
						{% for field in form %}
						<td>{{ field }}</td>
						{% endfor %}
						<td>
							<button class="add-entry-button" type="submit" name="add">Add entry</button>
						</td>
					</form>
				</tr>
				{% endif %}

				<!-- Show all entries as rows -->
				{% for entry in entries %}
				<tr>
					<!-- Editing mode-->
					{% if editing_entry and editing_entry.id == entry.id %}
					<form method="post" action="{% url 'playground' %}">
						{% csrf_token %}
						<input type="hidden" name="entry_id" value="{{ entry.id }}">
						{% for field in form %}
						<td>{{ field }}</td>
						{% endfor %}
						<td>
							<button class="save-entry-button" type="submit" name="save">Save</button>
						</td>
					</form>
					{% else %}
					<!-- If not in editing mode, just show entry date and description, button for edit and delete -->
					<td>{{ entry.entry_date }}</td>
					<td>{{ entry.description }}</td>
					<td>
						<form method="post" If not in editing mode, just show entry date and description, button for edit and deleteaction="{% url 'playground' %}" style="display:inline;">
							{% csrf_token %}
							<input type="hidden" name="entry_id" value="{{ entry.id }}">
							<button class="delete-button" type="submit" name="delete">Delete</button>
						</form>
						<form method="post" action="{% url 'playground' %}" style="display:inline;">
							{% csrf_token %}
							<input type="hidden" name="entry_id" value="{{ entry.id }}">
							<button class="edit-button" type="submit" name="edit">Edit</button>
						</form>
					</td>
					{% endif %}
				</tr>
				<tr>
				<!--
				1. Let's have subentries beneath the entry, smaller text,
				debit -> account option -> amount
				credit -> account option -> amount
				can change it, then save.
				A warning beneath the entry and subentries when Debit != Credit
				-->
								<td colspan="0">
						{% with subentries=entry_subentries|get_item:entry.id %}
						{% for subentry in subentries %}
						<p>{{ subentry }}</p> 
						{% endfor %}
						{% endwith %}
					</td>
				<tr>
					<form method="post" action="{% url 'playground' %}">
						{% csrf_token %}
						{% for field in edit_subentry_form %}
						<td>{{ field }}</td>
						{% endfor %}
						<td>
							<button class="save-entry-button" type="submit" name="save-subentry">Save</button>
						</td>
					</form>
				</tr>
				{% endfor %}

			</tbody>
		</table>
		{% endif %}

	</div>

	<div class="playground-financial-statement"> 
		{%include 'accounting/financial_statement.html'%}
	</div>
</div>

{% endblock content %}


